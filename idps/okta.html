<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Okta | SAML SSO Service Provider</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="SAML SSO Service Provider plugin for Craft CMS">
    
    <link rel="preload" href="/assets/css/0.styles.9cbc9ea8.css" as="style"><link rel="preload" href="/assets/js/app.401c3c6b.js" as="script"><link rel="preload" href="/assets/js/2.10e26c47.js" as="script"><link rel="preload" href="/assets/js/1.9bb73444.js" as="script"><link rel="preload" href="/assets/js/13.cffbdc71.js" as="script"><link rel="prefetch" href="/assets/js/10.3324c83c.js"><link rel="prefetch" href="/assets/js/11.27d36382.js"><link rel="prefetch" href="/assets/js/12.143bf57e.js"><link rel="prefetch" href="/assets/js/14.0cfda640.js"><link rel="prefetch" href="/assets/js/15.27e3a248.js"><link rel="prefetch" href="/assets/js/16.58196ea9.js"><link rel="prefetch" href="/assets/js/17.cb74d731.js"><link rel="prefetch" href="/assets/js/18.ea4aba3f.js"><link rel="prefetch" href="/assets/js/19.c8d6c14b.js"><link rel="prefetch" href="/assets/js/20.4b4a7f9d.js"><link rel="prefetch" href="/assets/js/21.9ac5ece0.js"><link rel="prefetch" href="/assets/js/22.85069bd1.js"><link rel="prefetch" href="/assets/js/23.885512a7.js"><link rel="prefetch" href="/assets/js/24.97d17fad.js"><link rel="prefetch" href="/assets/js/25.ccf588d8.js"><link rel="prefetch" href="/assets/js/26.928c22de.js"><link rel="prefetch" href="/assets/js/27.02647ed6.js"><link rel="prefetch" href="/assets/js/28.5cc106b7.js"><link rel="prefetch" href="/assets/js/29.d4cb2c02.js"><link rel="prefetch" href="/assets/js/3.50f33648.js"><link rel="prefetch" href="/assets/js/30.c96d97a9.js"><link rel="prefetch" href="/assets/js/31.11e540fc.js"><link rel="prefetch" href="/assets/js/32.211a4f7a.js"><link rel="prefetch" href="/assets/js/33.f1cdd157.js"><link rel="prefetch" href="/assets/js/34.dc383a22.js"><link rel="prefetch" href="/assets/js/35.1c63dc83.js"><link rel="prefetch" href="/assets/js/36.b27ae721.js"><link rel="prefetch" href="/assets/js/37.a61ead46.js"><link rel="prefetch" href="/assets/js/38.9fade013.js"><link rel="prefetch" href="/assets/js/4.c3bbd19c.js"><link rel="prefetch" href="/assets/js/5.81c000f8.js"><link rel="prefetch" href="/assets/js/6.3bba3ea6.js"><link rel="prefetch" href="/assets/js/7.e23775f3.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.857e8e87.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9cbc9ea8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/icon.svg" alt="SAML SSO Service Provider" class="logo"> <span class="site-name can-hide">SAML SSO Service Provider</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://www.flipboxdigital.com/craft-cms-plugins/saml-service-provider" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Details
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/flipboxfactory/saml-sp/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/flipboxfactory/saml-sp" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Repo
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://www.flipboxdigital.com/craft-cms-plugins/saml-service-provider" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Details
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/flipboxfactory/saml-sp/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/flipboxfactory/saml-sp" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Repo
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Getting Started</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Configure</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>IdPs</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/idps/" aria-current="page" class="sidebar-link">IdPs</a></li><li><a href="/idps/azure-ad.html" class="sidebar-link">Azure AD</a></li><li><a href="/idps/okta.html" aria-current="page" class="active sidebar-link">Okta</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/idps/okta.html#okta" class="sidebar-link">Okta</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Examples</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="okta"><a href="#okta" class="header-anchor">#</a> Okta</h2> <h3 id="create-the-craft-sp-provider-my-provider"><a href="#create-the-craft-sp-provider-my-provider" class="header-anchor">#</a> Create the Craft SP Provider (My Provider)</h3> <p>Within Craft CMS, after the plugin is installed, on the control panel left side navigation
click SAML Service Provider &gt; &quot;My Provider&quot;. Click &quot;Generate key pair&quot; (under the Security tab), label the provider, and
hit save.</p> <p>Then go back to the provider you just created and click on the Metadata tab. Leave this browser tab open for easy access
while configuring Okta.</p> <h3 id="create-the-application"><a href="#create-the-application" class="header-anchor">#</a> Create the Application</h3> <p><img src="/assets/img/okta-create-app.bc671cd3.png" alt="Create the Application"></p> <h4 id="general-settings"><a href="#general-settings" class="header-anchor">#</a> General Settings</h4> <p>Name the application accordingly and choose SAML 2.0 application.</p> <p><img src="/assets/img/okta-choose-saml.6d03a37b.png" alt="Choose SAML 2.0"></p> <p><img src="/assets/img/okta-general.f73a5c37.png" alt="Name the Application"></p> <h5>Configure SAML</h5> <ul><li>Single sign on URL: Set this to your Craft SP (My Provider) Assertion Consumer Service (ACS) found on the Metadata tab.
<ul><li>For example, <code>https://your-craft-domain.com/sso/login/1f85b98a-125a-4f34-8daf-4325077c065e</code></li></ul></li> <li>Audience URI (SP Entity ID): Set this to the SP entity ID</li> <li>Default RelayState: You can leave this blank</li> <li>Name ID format: can be left as blank</li> <li>Application username: Setting this to the Okta username is a good idea because if the user ever changes their email, their user in Craft will stay the same.</li> <li>Update application username on: You can leave this as &quot;Create and update&quot;</li></ul> <p><img src="/assets/img/okta-general-2.63d38d39.png" alt="Name the Application"></p> <h5>Advanced Setting</h5> <ul><li>Response: Signed</li> <li>Assertion Signature: Signed</li> <li>Signature Algorithm: leave on default</li> <li>Digest Algorithm: leave on default</li> <li>Assertion Encryption: For elevated security you can choose to encrypt but for this example, we'll leave as unencrypted due to us signing the Response and Assertion.</li> <li>Enable Single Logout: Checked
<ul><li>Single Logout URL: Set this to your Craft SP (My Provider) Single Logout Service URL found on the Metadata tab.
<ul><li>For example, <code>https://your-craft-domain.com/sso/logout/1f85b98a-125a-4f34-8daf-4325077c065e</code></li></ul></li> <li>SP Issuer: set as the Entity ID (same as the Entity ID set above)</li> <li>Signature Certificate: Download from the Craft SP (My Provider) Security Tab, in Craft, and hit upload.</li></ul></li> <li>Assertion Inline Hook: leave as is</li> <li>Honor Force Authentication: leave as is</li> <li>SAML Issuer ID: leave as is</li></ul> <p><img src="/assets/img/okta-advanced-settings.d489a7a3.png" alt="Advanced Settings"></p> <h5>Attribute Statement</h5> <p>These are the attributes sent over in the assertion. All of the attributes sent over from here can be mapped to the Craft user.
At the minimum, email is required. But for this example, we'll do first and last name as well.</p> <ul><li>Under the first attribute statement:
<ul><li>Name: <code>FirstName</code> ( 👈 this is what the Craft plugin will see as the attribute name)</li> <li>Name format: leave as is (unspecified)</li> <li>Value: <code>user.firstName</code></li></ul></li> <li>Under the second attribute statement:
<ul><li>Name: <code>LastName</code></li> <li>Name format: leave as is (unspecified)</li> <li>Value: <code>user.lastName</code></li></ul></li> <li>Under the third attribute statement:
<ul><li>Name: <code>Email</code></li> <li>Name format: leave as is (unspecified)</li> <li>Value: <code>user.email</code></li></ul></li></ul> <p><img src="/assets/img/okta-attribute-settings.3246b3d1.png" alt="Attribute Statement"></p> <h5>Group Attribute Statements (optional)</h5> <p>Here's where you can send over group data and sync it to Craft. For now, we'll skip this step.</p> <h5>Feedback</h5> <p>Just click Finish</p> <h4 id="assign-users"><a href="#assign-users" class="header-anchor">#</a> Assign Users</h4> <p>In Okta, on the application page for your newly created application, click the assignments tab, then the &quot;Assign&quot; and
assign users or groups as needed.</p> <p><img src="/assets/img/okta-assign-users.38b75d25.png" alt="Assign users"></p> <h3 id="copy-over-the-metadata-from-okta"><a href="#copy-over-the-metadata-from-okta" class="header-anchor">#</a> Copy Over the Metadata (From Okta)</h3> <p>After you click the &quot;Finish&quot; button on the Feedback page, there's a button on the right side column labeled
&quot;View SAML setup instructions&quot;. At the bottom of the page copy the XML in the &quot;Optional&quot; (Provide the following IDP metadata to your SP provider) field.</p> <p>Then run through the following step:</p> <ul><li>Within Craft CMS, goto the SAML Service Provider plugin and click &quot;Provider List&quot; &gt; &quot;+ Add Identity Provider&quot;</li> <li>On the provider page, Label the provider as needed (i.e., Okta Production) and paste the XML Metadata from Okta into the <code>2. Metadata XML</code> on the Metadata field</li> <li>Then, click on the Configure tab and setup the Mapping at the bottom as below (this will mirror what we configured in Okta):
<ul><li>Click on the &quot;+ Add a new mapping&quot; for first name:
<ul><li>Attribute Name: <code>FirstName</code></li> <li>Select &quot;First Name&quot; from the dropdown</li></ul></li> <li>Continue to last name:
<ul><li>Attribute Name: <code>LastName</code></li> <li>Select &quot;Last Name&quot;</li></ul></li> <li>Add email
<ul><li>Attribute Name: <code>Email</code></li> <li>Select &quot;Email&quot;</li></ul></li></ul></li> <li>Click Save</li></ul> <p><img src="/assets/img/craft-mapping-attributes.e22e3461.png" alt="Mapping Attributes"></p> <h3 id="finish-and-test"><a href="#finish-and-test" class="header-anchor">#</a> Finish and Test</h3> <p>Copy the UID from the new Okta and add/replace the <code>loginPath</code> value in Craft's <code>config/general.php</code> file, with this
format <code>/sso/login/request/&lt;okta-uid&gt;</code>.</p> <p>For example:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">return</span> <span class="token punctuation">[</span>
    <span class="token operator">...</span>
    <span class="token string single-quoted-string">'loginPath'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'/sso/login/request/f2885601-e655-49ac-a2c5-48e702db6bfa'</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</span></code></pre></div><p>To test, create a protected test page using like the following:</p> <div class="language-twig extra-class"><pre class="language-twig"><code><span class="token twig language-twig"><span class="token delimiter punctuation">{%</span> <span class="token tag-name keyword">requireLogin</span> <span class="token delimiter punctuation">%}</span></span>

<span class="token twig language-twig"><span class="token delimiter punctuation">{{</span> currentUser<span class="token punctuation">.</span>fullName <span class="token delimiter punctuation">}}</span></span>
<span class="token twig language-twig"><span class="token delimiter punctuation">{{</span> currentUser<span class="token punctuation">.</span>email <span class="token delimiter punctuation">}}</span></span>
<span class="token twig language-twig"><span class="token delimiter punctuation">{{</span> currentUser<span class="token punctuation">.</span>username <span class="token delimiter punctuation">}}</span></span>
<span class="token twig language-twig"><span class="token delimiter punctuation">{{</span> currentUser<span class="token punctuation">.</span>dateCreate <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p>Use an incognito tab or signed out from Craft, goto your newly created page and you be should redirected to the Okta (the IdP). Login
and see that you will be returned back to the newly created page.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/flipboxfactory/saml-sp/edit/master/docs/idps/okta.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/idps/azure-ad.html" class="prev">
        Azure AD
      </a></span> <span class="next"><a href="/examples/">
        Examples
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.401c3c6b.js" defer></script><script src="/assets/js/2.10e26c47.js" defer></script><script src="/assets/js/1.9bb73444.js" defer></script><script src="/assets/js/13.cffbdc71.js" defer></script>
  </body>
</html>
